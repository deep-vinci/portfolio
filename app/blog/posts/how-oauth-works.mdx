---
title: "How Oauth really works behind the scenes?"
publishedAt: "2025-01-18"
summary: "Explaining how oauth works from barebones."
---

### **How Oauth really works behind the scenes?**

OAuth is a widely used standard for authorization, allowing users to use their already verified account on third party site as a delegate to login on other sites without entering passwords. Despite it’s importance OAuth isn’t a primary focus in many full-stack development courses, leaving many developers to learn it on their own. Here’s a general overview of how OAuth works.

> In very simple words, Oauth is a on-demand temporary API key that only lets you access the resources approved by users.

And to get that _temporary_ API key you follow these basic steps.

Ensure you have created rhe new project in [console.cloud.google.com](https://console.cloud.google.com/) and copied **client_id** and **client_secret** to follow this guide.

![](https://cdn-images-1.medium.com/max/900/1*xxK7JSmMS0tSr-3t48Ye8A.png)

[https://support.google.com/cloud/answer/6158849?hl=en](https://support.google.com/cloud/answer/6158849?hl=en)

### User clicks “Login with Google”

1.  User clicks on a Login with google button, the url on button takes the user to screen where provider (ex: google) ask for login credentials.
2.  Once user allows the login, the Provider (that is google here) redirects to the URL mentioned in the consent screen URL query parameter, and sends back a code in query params (ex: localhost:3000?code=203981)
3.  This code sent back by google is called Authorization code.

This “Login with Google” button has a url which is something like this

```js
https://accounts.google.com/o/oauth2/v2/auth?client_id=86728315176&redirect_uri=http://localhost:3000/g_auth&response_type=code&scope=profile email
```

if you break down this url you will see it has few parameters

```js
{
    (client_id = "86728315176"),
        (redirect_uri = "http://localhost:3000/g_auth"),
        (response_type = "code"),
        (scope = "profile email");
}
```

Now, **client_id** is an Id you get when you make a project on [console.cloud.google.com](https://console.cloud.google.com/), **redirect_uri** is a url that google redirects after successful login with authorization code, **response_type** tells the google what is needs in response, which is code, short for authorization code. **Scope** is permissions that user is asking to access here its, profile and email.

### Authorization Code is returned by Google Server.

This code is sent as a url parameter on the **redirect_uri.**

```js
http://localhost:3000/g_auth?code=920438
```

The _/g_auth_ path can then be handled by your server to retireve the code=920438

### You Send that code back to Google Server.

Once you have retrieved the code, now you can make a post request to the google server to get an API key, which is called **access token** in Oauth terms.

![](https://cdn-images-1.medium.com/max/900/1*YQmi3o-UZ51bej5tW6j9mQ.jpeg)

```js
const response = await axios.post("https://oauth2.googleapis.com/token", {
    code,
    client_id: process.env.GOOGLE_CLIENT_ID,
    cient_secret: process.env.GOOGLE_CLIENT_SECRET,
    redirect_uri: "http://localhost:3000/g_auth",
    grant_type: "authorization_code",
});
```

This is the following post request you will make where **code** is the Authorization code you retrieved earlier, **client_id** and **client_secret** is a id you get when you make a new project on [console.cloud.google.com](https://console.cloud.google.com/). **redirect_uri** again is a redirect url, that is mostly present for security reasons. **grant_type** is defining the type of data you need, for example Authorization code here.

![](https://cdn-images-1.medium.com/max/900/1*YQmi3o-UZ51bej5tW6j9mQ.jpeg)

### Access Token received can now used as an API key.

```js
const userInfoResponse = await axios.get('https://www.googleapis.com/oauth2/v2/userinfo',
    headers: {
        Authorization: `Bearer ${access_token}`,
    },
});
```

this will respond with user information in JSON object, now you can pretty much use this simple guide to call any API either for auth or for just data.

Happy building:)
